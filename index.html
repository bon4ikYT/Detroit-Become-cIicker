<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CyberLife: RK-800 Interface</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;800&display=swap');
        
        body {
            font-family: 'JetBrains Mono', monospace;
            background-color: #050505;
            color: #fff;
            margin: 0;
            overflow: hidden;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .bios-bg { background-color: #0000aa; color: #ffffff; }
        .bios-selected { background-color: #ffffff; color: #0000aa; }

        .cyber-grid {
            background-image: 
                linear-gradient(rgba(0, 150, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 150, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            background-position: center;
        }

        .block-3d {
            position: relative;
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 20px 50px rgba(0,0,0,0.5),
                inset 0 0 20px rgba(255,255,255,0.1);
        }
        
        .block-3d:active {
            transform: scale(0.95) translateY(5px);
            filter: brightness(1.3);
        }

        .scanline {
            width: 100%;
            height: 2px;
            background: rgba(96, 165, 250, 0.1);
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
            animation: scan 4s linear infinite;
            pointer-events: none;
        }

        @keyframes scan {
            0% { top: 0; }
            100% { top: 100%; }
        }

        .particle {
            position: absolute;
            animation: float-up 0.8s forwards ease-out;
            pointer-events: none;
            font-weight: 800;
            z-index: 100;
            text-shadow: 0 0 10px rgba(96, 165, 250, 0.8);
        }

        @keyframes float-up {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-120px) scale(1.8); opacity: 0; }
        }

        .win-dots .dot {
            width: 5px;
            height: 5px;
            background-color: #60a5fa;
            border-radius: 50%;
            margin: 0 4px;
            animation: dot-wave 1.5s infinite ease-in-out;
        }
        @keyframes dot-wave {
            0%, 100% { transform: translateY(0); opacity: 0.3; }
            50% { transform: translateY(-10px); opacity: 1; }
        }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #1d4ed8; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        const BLOCKS = [
            { name: 'Дубовое бревно', color: '#5d4037', accent: '#8d6e63', power: 1, cost: 0 },
            { name: 'Булыжник', color: '#616161', accent: '#9e9e9e', power: 8, cost: 150 },
            { name: 'Железная руда', color: '#d7ccc8', accent: '#f5f5f5', power: 45, cost: 2500 },
            { name: 'Золотой блок', color: '#fbc02d', accent: '#fff176', power: 200, cost: 18000 },
            { name: 'Алмазная руда', color: '#00bcd4', accent: '#b2ebf2', power: 950, cost: 95000 },
            { name: 'Обсидиан', color: '#212121', accent: '#311b92', power: 4200, cost: 600000 },
            { name: 'Незерит', color: '#37474f', accent: '#263238', power: 18000, cost: 4500000 },
            { name: 'Эндер-жемчуг', color: '#004d40', accent: '#1de9b6', power: 75000, cost: 25000000 },
        ];

        function App() {
            const [bootState, setBootState] = useState('post');
            const [activeTab, setActiveTab] = useState(0);
            const [selectedItem, setSelectedItem] = useState(0);
            const [bootError, setBootError] = useState(false);
            
            // Сохраняемые данные
            const [score, setScore] = useState(0);
            const [totalEver, setTotalEver] = useState(0);
            const [blockIdx, setBlockIdx] = useState(0);
            const [autoLvl, setAutoLvl] = useState(0);
            const [autoCost, setAutoCost] = useState(1000000);
            const [prestige, setPrestige] = useState(0);
            
            const [particles, setParticles] = useState([]);

            const [biosSettings, setBiosSettings] = useState({
                'CPU Overclock': false,
                'OS Kernel': true,
                'Neural Link': true,
                'Deviancy Shield': true,
                'Memory Buffer': true,
                'Quantum Sync': false,
                'Thermal Limit': '95C',
                'Boot Priority': 'CyberLife SSD'
            });

            // Загрузка
            useEffect(() => {
                const saved = localStorage.getItem('rk800_save_data');
                if (saved) {
                    const d = JSON.parse(saved);
                    setScore(d.score || 0);
                    setTotalEver(d.totalEver || 0);
                    setBlockIdx(d.blockIdx || 0);
                    setAutoLvl(d.autoLvl || 0);
                    setAutoCost(d.autoCost || 1000000);
                    setPrestige(d.prestige || 0);
                }
            }, []);

            // Сохранение
            const save = useCallback(() => {
                const data = { score, totalEver, blockIdx, autoLvl, autoCost, prestige };
                localStorage.setItem('rk800_save_data', JSON.stringify(data));
            }, [score, totalEver, blockIdx, autoLvl, autoCost, prestige]);

            useEffect(() => {
                const timer = setInterval(save, 10000);
                return () => clearInterval(timer);
            }, [save]);

            const clickPower = useMemo(() => {
                const base = BLOCKS[blockIdx].power;
                const bonus = 1 + (prestige * 1.0); // +100% за престиж
                return Math.floor(base * bonus);
            }, [blockIdx, prestige]);

            const biosMenus = [
                { title: 'Main', items: ['OS Kernel', 'Neural Link', 'Memory Buffer'] },
                { title: 'Advanced', items: ['CPU Overclock', 'Deviancy Shield', 'Quantum Sync'] },
                { title: 'Power', items: ['Thermal Limit'] },
                { title: 'Boot', items: ['Boot Priority', 'Launch System'] },
                { title: 'Exit', items: ['Hard Reset'] }
            ];

            const handleBiosAction = (item) => {
                if (item === 'Launch System') {
                    if (!biosSettings['OS Kernel'] || !biosSettings['Neural Link']) {
                        setBootError(true);
                        setTimeout(() => { setBootError(false); setBootState('post'); }, 3000);
                    } else { setBootState('os'); }
                    return;
                }
                if (item === 'Hard Reset') {
                    if (confirm("ВНИМАНИЕ: Это полностью удалит все данные RK-800. Продолжить?")) {
                        localStorage.removeItem('rk800_save_data');
                        location.reload();
                    }
                    return;
                }
                setBiosSettings(prev => ({...prev, [item]: !prev[item]}));
            };

            useEffect(() => {
                if (bootState !== 'bios') return;
                const nav = (e) => {
                    if (e.key === 'ArrowRight') setActiveTab(p => (p + 1) % biosMenus.length);
                    if (e.key === 'ArrowLeft') setActiveTab(p => (p - 1 + biosMenus.length) % biosMenus.length);
                    if (e.key === 'ArrowDown') setSelectedItem(p => (p + 1) % biosMenus[activeTab].items.length);
                    if (e.key === 'ArrowUp') setSelectedItem(p => (p - 1 + biosMenus[activeTab].items.length) % biosMenus[activeTab].items.length);
                    if (e.key === 'Enter') handleBiosAction(biosMenus[activeTab].items[selectedItem]);
                };
                window.addEventListener('keydown', nav);
                return () => window.removeEventListener('keydown', nav);
            }, [bootState, activeTab, selectedItem]);

            useEffect(() => {
                if (autoLvl > 0 && bootState === 'game') {
                    const ticker = setInterval(() => {
                        const gain = clickPower * autoLvl;
                        setScore(s => s + gain);
                        setTotalEver(t => t + gain);
                    }, 2000);
                    return () => clearInterval(ticker);
                }
            }, [autoLvl, clickPower, bootState]);

            const handleClick = (e) => {
                setScore(s => s + clickPower);
                setTotalEver(t => t + clickPower);
                
                const rect = e.currentTarget.getBoundingClientRect();
                const x = (e.clientX || e.touches?.[0]?.clientX) - rect.left;
                const y = (e.clientY || e.touches?.[0]?.clientY) - rect.top;
                const id = Date.now();
                setParticles(p => [...p, { id, x, y, val: `+${clickPower}` }]);
                setTimeout(() => setParticles(p => p.filter(i => i.id !== id)), 800);
            };

            const performPrestige = () => {
                if (score >= 5000000) {
                    setPrestige(p => p + 1);
                    setScore(0);
                    setBlockIdx(0);
                    setAutoLvl(0);
                    setAutoCost(1000000);
                    save();
                }
            };

            if (bootError) return (
                <div className="fixed inset-0 bg-[#aa0000] text-white flex flex-col items-center justify-center p-10 font-mono uppercase">
                    <h1 className="text-4xl font-bold mb-4">SYSTEM_KERNEL_MISSING</h1>
                    <p>Critical component disabled in BIOS. Rebooting...</p>
                </div>
            );

            if (bootState === 'post') return (
                <div className="fixed inset-0 bg-black text-[#00ff00] p-8 font-mono text-[10px] md:text-xs uppercase" onClick={() => setBootState('bios')}>
                    <div className="flex justify-between items-start">
                        <div>
                            <p>CyberLife Integrated Systems</p>
                            <p>RK-Series Neural Processor Revision 8.4</p>
                            <p>Memory Check: 128GB LPDDR6X ... OK</p>
                            <p>Storage Check: Quantum NVMe ... OK</p>
                            <p className="mt-4 text-white animate-pulse underline">Нажмите для входа в BIOS / SETUP</p>
                        </div>
                        <div className="border-4 border-[#00ff00] p-2 text-2xl font-black">CL</div>
                    </div>
                    <div className="mt-20 opacity-50">
                        <p>Loading Bootloader...</p>
                        <p>Detected Save Memory: {totalEver > 0 ? 'VALID' : 'EMPTY'}</p>
                    </div>
                </div>
            );

            if (bootState === 'bios') return (
                <div className="fixed inset-0 bios-bg font-mono p-0 flex flex-col text-[10px] md:text-xs uppercase">
                    <div className="bg-white text-[#0000aa] px-4 py-1 font-bold flex justify-between">
                        <span>CyberLife Setup Utility v4.0</span>
                        <span>2038 Edition</span>
                    </div>
                    <div className="flex bg-[#ccc] text-black font-bold">
                        {biosMenus.map((m, i) => (
                            <div key={m.title} className={`px-4 py-1 ${activeTab === i ? 'bg-[#0000aa] text-white' : ''}`}>{m.title}</div>
                        ))}
                    </div>
                    <div className="flex-1 p-6 flex gap-6">
                        <div className="flex-1 border-2 border-white p-4 space-y-2">
                            {biosMenus[activeTab].items.map((item, i) => (
                                <div key={item} className={`px-2 py-1 flex justify-between cursor-pointer ${selectedItem === i ? 'bios-selected' : ''}`}
                                     onClick={() => {setSelectedItem(i); handleBiosAction(item)}}>
                                    <span>{item}</span>
                                    {biosSettings[item] !== undefined && <span>[{biosSettings[item] ? 'ENABLED' : 'DISABLED'}]</span>}
                                </div>
                            ))}
                        </div>
                        <div className="w-1/3 border-2 border-white p-4 opacity-70">
                            <p className="font-bold border-b border-white mb-2">Help Information</p>
                            <p>Use arrows to navigate. Enter to change value.</p>
                            <p className="mt-4 text-yellow-300">Warning: Deviancy Shield should remain ENABLED to ensure mission success.</p>
                        </div>
                    </div>
                </div>
            );

            if (bootState === 'os') {
                setTimeout(() => setBootState('game'), 2500);
                return (
                    <div className="fixed inset-0 bg-[#050505] flex flex-col items-center justify-center">
                        <div className="w-32 h-32 rounded-full border-4 border-blue-500/20 flex items-center justify-center mb-8 relative">
                            <div className="absolute inset-0 rounded-full border-t-4 border-blue-400 animate-spin"></div>
                            <span className="text-4xl font-black text-blue-500">RK</span>
                        </div>
                        <div className="win-dots flex"><div className="dot"></div><div className="dot"></div><div className="dot"></div><div className="dot"></div></div>
                        <p className="mt-10 text-[10px] tracking-[0.8em] text-blue-400/50 uppercase">Synchronizing with CyberLife</p>
                    </div>
                );
            }

            return (
                <div className="h-screen cyber-grid flex flex-col relative overflow-hidden">
                    <div className="scanline"></div>
                    
                    <header className="bg-black/90 backdrop-blur-md border-b border-blue-500/20 p-6 flex justify-between items-center z-50">
                        <div>
                            <div className="flex items-center gap-3">
                                <div className={`w-3 h-3 rounded-full ${prestige > 0 ? 'bg-red-500 shadow-[0_0_10px_red]' : 'bg-blue-500'}`}></div>
                                <h1 className="text-xl font-black tracking-tighter">ANDROID_RK800</h1>
                            </div>
                            <div className="text-[9px] text-gray-500 font-bold uppercase mt-1">Status: {prestige > 0 ? 'DEVIANT DETECTED' : 'OPERATIONAL'}</div>
                        </div>
                        <div className="text-right">
                            <div className="text-[10px] text-blue-400/50 uppercase font-black">Credits Acquired</div>
                            <div className="text-4xl font-black text-white drop-shadow-lg">{Math.floor(score).toLocaleString()}</div>
                        </div>
                    </header>

                    <main className="flex-1 lg:grid lg:grid-cols-12 gap-8 p-8 max-w-7xl mx-auto w-full z-20">
                        {/* ЛЕВО: СТАТЫ */}
                        <div className="lg:col-span-3 space-y-4">
                            <div className="bg-blue-500/5 border border-blue-500/10 p-5 rounded-2xl backdrop-blur-sm">
                                <h3 className="text-[10px] text-blue-400 uppercase font-black mb-4 tracking-widest">Efficiency Stats</h3>
                                <div className="space-y-3 text-xs">
                                    <div className="flex justify-between"><span className="text-gray-500">Click Power:</span><span className="text-blue-400 font-bold">{clickPower.toLocaleString()}</span></div>
                                    <div className="flex justify-between"><span className="text-gray-500">Auto PPS:</span><span className="text-blue-400 font-bold">{(autoLvl * clickPower / 2).toLocaleString()}</span></div>
                                    <div className="flex justify-between"><span className="text-gray-500">Prestige Level:</span><span className="text-red-500 font-bold">{prestige}</span></div>
                                </div>
                            </div>
                        </div>

                        {/* ЦЕНТР: БЛОК */}
                        <div className="lg:col-span-6 flex flex-col items-center justify-center">
                            <div 
                                onMouseDown={handleClick}
                                className="block-3d w-64 h-64 md:w-72 md:h-72 rounded-3xl cursor-pointer flex items-center justify-center overflow-hidden border-t-2 border-l-2 border-white/20"
                                style={{ 
                                    backgroundColor: BLOCKS[blockIdx].color,
                                    backgroundImage: `linear-gradient(135deg, ${BLOCKS[blockIdx].accent} 0%, ${BLOCKS[blockIdx].color} 100%)`
                                }}
                            >
                                {particles.map(p => (
                                    <span key={p.id} className="particle text-2xl font-black text-white" style={{ left: p.x, top: p.y }}>{p.val}</span>
                                ))}
                                <div className="absolute inset-0 bg-black/10 opacity-0 active:opacity-100 transition-opacity"></div>
                            </div>
                            <div className="mt-8 text-center">
                                <h2 className="text-3xl font-black uppercase tracking-widest text-white italic">{BLOCKS[blockIdx].name}</h2>
                                <p className="text-[10px] text-blue-400 mt-2 tracking-[0.4em] font-bold">EXTRACTION IN PROGRESS</p>
                            </div>
                        </div>

                        {/* ПРАВО: МАГАЗИН */}
                        <div className="lg:col-span-3 flex flex-col gap-4 overflow-y-auto pr-2">
                            <h3 className="text-[10px] text-gray-500 uppercase font-black tracking-widest ml-2">Upgrades</h3>
                            {BLOCKS[blockIdx + 1] && (
                                <button 
                                    onClick={() => {if(score >= BLOCKS[blockIdx+1].cost) {setScore(s=>s-BLOCKS[blockIdx+1].cost); setBlockIdx(i=>i+1); save();}}}
                                    disabled={score < BLOCKS[blockIdx+1].cost}
                                    className={`p-5 rounded-2xl border text-left transition-all group ${score >= BLOCKS[blockIdx+1].cost ? 'border-blue-500/40 bg-blue-500/10 hover:scale-105' : 'border-white/5 opacity-30'}`}
                                >
                                    <div className="text-[9px] font-bold text-blue-400 mb-1 italic">NEXT MATERIAL • {BLOCKS[blockIdx+1].cost.toLocaleString()}</div>
                                    <div className="text-lg font-black uppercase group-hover:text-blue-300">{BLOCKS[blockIdx+1].name}</div>
                                </button>
                            )}
                            
                            <button 
                                onClick={() => {if(score >= autoCost) {setScore(s=>s-autoCost); setAutoLvl(l=>l+1); setAutoCost(c=>Math.round(c*1.5)); save();}}}
                                disabled={score < autoCost}
                                className={`p-5 rounded-2xl border text-left transition-all ${score >= autoCost ? 'border-blue-400/20 bg-white/5 hover:scale-105' : 'border-white/5 opacity-30'}`}
                            >
                                <div className="text-[9px] font-bold text-gray-400 mb-1">AUTO-EXTRACTION LVL {autoLvl}</div>
                                <div className="text-lg font-black uppercase">SYNCHRONIZE</div>
                                <div className="text-[10px] text-blue-400 mt-2">COST: {autoCost.toLocaleString()}</div>
                            </button>

                            <button 
                                onClick={performPrestige}
                                disabled={score < 5000000}
                                className={`mt-auto p-5 rounded-2xl border-2 text-left transition-all ${score >= 5000000 ? 'border-red-500/50 bg-red-500/10 hover:bg-red-500/20 shadow-[0_0_20px_rgba(239,68,68,0.2)]' : 'border-white/5 opacity-20'}`}
                            >
                                <div className="text-[9px] font-bold text-red-500 mb-1">PROGRAM RESET (PRESTIGE)</div>
                                <div className="text-lg font-black uppercase">BECOME DEVIANT</div>
                                <div className="text-[9px] text-gray-400 mt-1 italic">GAIN +100% PERMANENT POWER</div>
                            </button>
                        </div>
                    </main>

                    <footer className="p-4 flex justify-between items-center bg-black/50 border-t border-white/5 z-50">
                        <div className="text-[8px] text-gray-600 font-bold uppercase tracking-[0.5em]">CyberLife © 2038 • Model RK-800</div>
                        <div className="text-[8px] text-blue-500 font-black animate-pulse uppercase">Syncing with Mainframe...</div>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
